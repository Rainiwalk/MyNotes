### 定义

无监督学习最常见的算法。

**聚类(Clustering)**：就是将相似的事物聚集在一起，而将不相似的事物划分到不同的类别的过程。它是一种探索性的分析，不必事先给出一个分类标准，聚类分析能够从样本数据出发，自动进行分类。

**聚类分析所使用的方法不同，常常会得到不同的结论。**



常见算法：层次聚类、划分聚类、基于密度的聚类...

![image-20210726213433444](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210726213433.png)





举个例子，经典的鸢尾花样例.

![image-20210726214010254](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210726214010.png)



最开始我可能是根据数据画出了一个折线图(如下)，大概可以发现有三种曲线走向。

然后按照3类聚类就是这样如下.

![image-20210726214139266](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210726214139.png)





### 常用算法

* K均值(K-Means)
* DBScan
* 最大期望(EM：Expectation Maximization)
* 降维：PCA(主成分分析)、PLS(偏最小二乘回归)、MDS(多维尺度分析)...





### 最常见的聚类方法：K-Means

#### 定义

K-Means即K均值聚类，属于划分聚类。其工作原理为根据初始化的聚类中心信息，计算每个样本到这些中心的距离，可以判断每个样本均归属于某个类簇(cu)，更新聚簇中心信息，重新计算每个样本到新的聚类中心的距离，重新划分样本到新的聚类中心对应的类中，重复进行，直到满足终止条件。



#### 算法描述

![image-20210726214641043](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210726214641.png)



为什么会更新中心点：因为加入新的分好的点以后，整体中心就会偏移。

直到最后，直到每个聚类中心点都不再发生变化(当前聚类已经稳定，每次更新都不会有新的归属的变更)或者变化幅度小于给定阈值，或者达到预定义的最大循环次数，就结束了。





#### 实现步骤图示

第一步：确定聚类个数，确定聚类中心，确定距离计算公式。

![image-20210727202642966](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210727202643.png)

可以直接观察判断，可以画画什么折线图看看，或者采用别的技术手段，比如随机取。

假设右图就是一个随机取的，确定了三个中心点。



第二步：计算每个点和聚类中心点的距离，归类

暂且还是用欧式距离。

![image-20210727202904867](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210727202904.png)

左图正在计算到三个中心点的距离，最后发现离上面那个最近，就归为那一类。

都走完就变到了右图。

然后我们发现类里的记录数发生了变化，那么类的中心也会发生变化。

So...



第三步：计算当前类簇中心，更新聚类中心Ck的位置

![image-20210727203125689](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210727203125.png)

这样就调整了类中心的位置。

这样类中心发生了变化，那么样本到各个类中的距离也就发生了变化，于是还要重复过程。



##### 疑问：这里怎么计算新的聚类中心的呢？

是不是从一个点开始，与剩余点一次一次取中点迭代，最后的中点结果就是整体的中心点了呢？

有点道理，而且我自己观察推断，最终找到的中点与中间迭代的点顺序没有关系，只要去取中点，最后就是一个固定点。



重复第二步：将各样本Si点根据新聚类中心Ck进行重新划分

重复第三步：根据最新聚类计算聚类中心，更新中心Ck取值



![image-20210727203507101](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210727203507.png)



如此重复，直到中心不再发生变换或幅度足够小，或循环达到次数限制，结束。

得到最终聚类结果，3个最终聚类中心。

![image-20210727203645794](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210727203645.png)





伪码

* 选择k个点作为初始类簇中心
* repeat
  * 将每个样本点指派到最近的类簇中心，形成k个类簇
  * 重新计算每个类簇中心
* until 类簇不发生变化 or 达到最大迭代次数







#### 优缺点

![image-20210727203947764](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210727203947.png)

缺点中：

k不好提前确定，但又影响很大。

欧式距离对球状很ok，但别的不行，比如右边这个就不太行。合理的分发是三个环，但K-Means只能划分成三个扇形。

异常值很敏感：想一下就知道，本来没有他很稳定，但有了它再很远的地方，可以一己之力就可以把中心向那个方向拖动好远。

对离散值要特殊处理：因为连续的一般都是数值，但是离散的东西，比如性别，教育水平什么的，就需要你处理成数值。



