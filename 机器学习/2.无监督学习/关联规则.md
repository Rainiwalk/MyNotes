### 定义

关联规则(Association Rule)是反映事物与事物之间相互的依存关系和关联性。如果两个或多个事物间存在一定的关联关系，则其中一个事物能够通过其他事物预测到。

关联规则挖掘可以让我们从数据集中发现项与项之间的关系。

最常见的场景就是购物篮分析(Market Basket)。通过分析购物篮中的不同商品之间的关系，来分析顾客的购买习惯。经典案例就是**啤酒与尿布**。

根据某超市的购物篮信息，分析顾客的购物习惯，制定货物摆放或者捆绑销售策略。(Apriori)



### 常用算法

* Apriori
* Eclat





---







### 重要概念

下面是一个超市购物样例

![img](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210801091330.jpeg)



#### 支持度

支持度：某个商品组合出现的次数与总次数之间的比例。

比如"牛奶"这个组合，在5次订单中出现了4次，所以它的支持度就是4/5 = 80%

"牛奶、面包"就是60%



#### 置信度

一个条件概率，就是说在 A 发生的情况下，B 发生的概率是多少。

置信度（牛奶→啤酒）=2/4=0.5，代表如果你购买了牛奶，有多大的概率会购买啤酒？

这里的数字，可以理解为条件概率的古典概率形态。

P(啤酒|牛奶) = P(同时买牛奶+啤酒) / P(买牛奶) = 2/4



#### 提升度

我们在做商品推荐的时候，重点考虑的是提升度，因为提升度代表的是“商品 A 的出现，对商品 B 的出现概率提升的”程度。

```
提升度 (A→B)= 置信度 (A→B)/ 支持度 (B)
```

附：这个公式是用来衡量 A 出现的情况下，是否会对 B 出现的概率有所提升。



所以提升度有三种可能：

提升度 (A→B)>1：代表有提升；

提升度 (A→B)=1：代表有没有提升，也没有下降；

提升度 (A→B)<1：代表有下降。





### Apriori算法

它是第一个关联规则挖掘算法，也是最经典的算法。

它利用逐层搜索的迭代方法找出数据库中项集的关系，以形成规则，其过程由连接（类矩阵运算）与剪枝（去掉那些没必要的中间结果）组成。

该算法中项集的概念即为项的集合。包含K个项的集合为k项集。

项集出现的频率是包含项集的事务数，称为项集的频率。如

果某项集满足最小支持度，则称它为频繁项集。





下面来看一个使用样例

![image-20210801092226292](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210801092226.png)

首先是给出现在的一个超市流水清单。

自己订立最小支持度和最小置信度的比例。



**然后开始执行算法，首先是求频繁项集。**

先是第一级的，即 1-频繁项集。

![image-20210801092408007](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210801092408.png)



**D只有25%，不满足最小支持度，所以扔掉它。**

结果就是A 50% ，B 75%，C 75%，E 75.



然后是 2-频繁项集，是对1-频繁项集项的组合。

![image-20210801092604007](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210801092604.png)



最后是3-频繁项集，**"画x"是因为组合元素为4，不满足3的框架，删掉。**

![image-20210801092625292](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210801092625.png)



最后只剩下 {B,C,E}的组合。

已经没有更深组合可能了，这也就是最后结果了。

附：这里虽然最终确定结果是一个频繁K项集，但结果并非总为1个。这里只是数据量较小，一旦较大，可能结汇生成很多个结果。



至此，最终结果项集已然找到，接下来就该找关联规则了。

**将获得的最终的频繁K项集，依次取出(可能不止一个)。同时计算该次取出的这个K项集的所有非空真子集，然后以排列组合的方式生成关联规则，并计算规则的置信度以及提升度，将符合要求的关联规则生成提出，最终算法结束。**



非空真子集是B,C,E,{B,C},{B,E},{C,E}

排列组合的关联规则：

B->C，B->E，B->{C，E}....

理解：**前面有它，结果也有它是不行的，这样的组合是无效的(前后都有它，应该说这个它与规则是没有关系的，那么我们就可以删除它，而删除公共元素后的结果我们已经考虑在内了)。**但是这里不是从前向后，而是依次选择开头，然后与剩余所有进行组合尝试。因为B->C和C->B是不一样的。

结果应该是12种。



然后就根据最后组合确定了关联规则(这里表格有点问题，最后讨论照耀看置信度和提升度，已经和支持度没关系了，最小置信度就是用在这里的，满足的才好去应用)

![image-20210801092832867](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210801092832.png)



**最终输出结果(应该是不全)**

![image-20210801093116118](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210801093116.png)

这个表中的关联规则都可以用于指定商品摆放售卖策略。





