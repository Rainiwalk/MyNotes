之前统计学学习的东西，应该好好复习复习



### 模型比较

我们选择了合适的评估方法和相应的性能度量后，我们是可以计算出性能度量然后**直接进行比较**的。

但是会存在以下问题：

* 模型评估得到的是测试集上的性能，并非严格意义上的泛化性能，两者并不完全相同

  因为测试集并不能代表数据全集，我们也只是进行近似估计

* 测试集上的性能与样本选取关系很大，不同的划分，测试结果会不同，比较缺乏稳定性

* 很多模型本身具有随机性，即使参数和数据集相同，其运行结果也存在差异

  比如random forest，在训练时会随机取一些行和列，每次都可能会不一样



把上面带来的问题用统计学知识描述一下：

**已知两个模型f1和f2，两者的泛化性能在测试集上的表现不同，f1好于f2，请检验在统计意义上f1是否好于f2？这个把握有多大？**



理解：哦哦哦，有点和概率论最后的**假设检验**有关。就是说你不能凭感觉来近似那些东西，你说在这个小部分上f1比f2好，那么整体也是，这不是感觉的东西，需要证据，也就是数学的证明。





举个例子来理解这个问题.

![image-20210804105236007](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804105243.png)



假设没问题，投掷结果是个二项分布。可以算出连续为正的概率。

如果有个人说他投掷一次肯定会出现正面，那这件事可能性就是50%，很高的。

连续两次，25%，也不低。

....



而我们要做一个判断，我们认为，在它说的那件事发生概率低于一个值时，我们就不认为它容易发生了。这里的5次的3%通常我们就认为是个小概率事件了。

我们通常认为5%就是那个值，如果事件发生概率小于它，就不太可能发生了。

这个5%就是假设检验用到的值。





具体来了解假设检验。



### 假设检验

**统计假设检验(Hypothesis Test)：**事先对总体的参数或者分布做一个假设，然后基于已有的样本数据去判断这个假设是否合理。即样本和总体假设之间的不同是纯属机会变异(因为随机性误差导致的不同)，还是两者确实不同。常用的假设检验方法有t-检验法、X2检验法(卡方检验)、F-检验法等。



理解：就是通过样本数据来判断一下我对事物的一些认知是否是对的



#### 基本思想

* 从样本推断整体

* 通过反证法推断假设是否成立

* 小概率事件在一次实验中基本不会发生

* 不轻易拒绝原假设

* 通过显著性水平定义小概率事件不可能发生的概率

* 全称命题只能被否定而不能被证明

  很难证明一个假设成立，你可能需要列举所有的可能，但是证明不成立，只需要找到反例就好了



开始我有一些样本数据，但对整体的一些信息我并不知道，现在有一些假设的可能，我将采用反证法来验证是否正确。假设我整体确实满足这种分布，如果出现当前样本的概率非常小，那我就认为我的假设不成立。





#### 具体步骤

1.建立假设

![image-20210804110828489](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804110828.png)

备择假设就是原假设的反面，二者互逆。

后面的"不等于、降低"等是在题目中的描述语言，就是说你遇到"不等于"，那这就是双尾假设的东西。

就按照那个形式去假设。



只有小概率事件发生了，你才能拒绝原假设，在检验过程中你是要保证原假设的(肯定)。



2.确定检验水准

![image-20210804113224107](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804113224.png)

实际上检验水平α=0.05是说：如果原假设正确，我们做100次判断，其中有5次错误地拒绝了正确的假设，这就是一个容忍度，容忍你5%的犯错概率。



3.构造统计量

![image-20210804113447316](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804113447.png)

就是具体你去参与计算的那个东西.

统计量是相对的，选用不同的方法就要安排不同的统计量。

附：想深入了解这方面可以看《商务与经济统计》。

![image-20210804113821894](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804113822.png)







4.计算P值

![image-20210804113909336](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804113909.png)





5.得到结论

![image-20210804114038506](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804114038.png)

如果p在左侧小范围内，就可以拒绝，否则就不能确定(没法说别的)



我们可以用这个过程走一遍"掷硬币问题"。

她扔了10次，每次都是证明。

我们想假设检验，实际上我们更希望(觉得)去认为硬币是有问题的，因为那个概率的猜想。

所以我们设置原假设H0：硬币没有问题，(因为原假设是我们要收集证据去推翻的东西)

然后在没问题前提下我们要去计算相应统计量，最后比如发现p = 0.0009,小于检验水准α = 0.05，那我们就认为小概率事件发生了，就拒绝原假设。

这就说明硬币大概率是有问题的。

附：这里好像是因为二项分布比较简单，直接用p^10就能得到发生那个事件的概率，和我们预测的5%比较，小，那我们认为这应该是个小概率事件，不应该发生的。但结果却发生了，也就说明硬币真的有问题了。



再来考虑，如果她说能连续投掷两次正面。

假设还是同上...

最后0.25>0.05，所以我们不能拒绝原假设，也就不能说硬币有问题，但是也无法断定硬币没问题。相当于什么都没发现。







### 假设检验例子：二项式检验



样例：某工厂的一批产品，其次品率μ未知，按规定，如果μ<=0.01，则该批产品可以接受。随机取样本100个，发现有3件次品，该批产品是否达标？

猜想一下，应该是不达标的，认为次品率应该是3%(后续结果并不符合我们最初猜想是因为随机性的因素)。



**具体步骤推演...**

确定假设：我们搜集数据是为了找到不达标的证据，即原假设H0：μ<=0.01，备择假设H1：μ>0.01

确定检验水平：采取最常用的α=0.05，或者更严格的α = 0.01

构造统计量：产品是否合格符号二项分布，原假设成立，则满足 b(k;n,0.01)

计算p值：

![image-20210804163041558](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804163048.png)



得到结论：p值大于显著水平α，不能拒绝原假设，即通过本次采样得到的样本数据，并不能证明原假设H0不成立

现在就是不能证明H0不成立，也不能证明其成立。总之目前次品率到底是低于0.01还是高于0.01，在没有更多证据之前，没有任何结论。



理解：这也就说明，假设检验证明的结果和我们的第一直觉未必就一样，所以还是需要算的







### 假设检验例子：T检验

某网站搞了一波市场活动，活动前一周的PV(单位：万)为1.40，1.38，1.43，1.42，1.44，1.37，1.41，活动后六天的PV(单位：万)为1.35，1.40，1.42，1.36，1.38，1.40。问活动对PV有无影响？假设活动前后PV均符合正态分布，且方差相同。



确定假设：我们想通过数据证明二者不同，即原假设H0：μ1=μ2，备择假设H1：μ1≠μ2.

确定检验水平：采取最常用的α=0.05

构造统计量：两者均符合正态分布，且等方差，方差未知，使用T检验；T检验结果如下：

![image-20210804164039410](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804164039.png)





计算p值，确定拒绝域：查T分布临界值表，

![image-20210804164154739](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804164154.png)

结果

![image-20210804164214486](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804164214.png)



得到结论：p值大于显著水平α，不能拒绝原假设，即无法证明活动有效果

这就是说明结果不确定，你的活动有可能白搞了，或者就是你去收集更多数据来进一步检验





**总结：**

可能在假设检验这里会看起来很乱，但是主要还是注意几点。

* 假设怎么设置(老师讲的是和感觉反着来，但当时我们老师好像要求带等号的是H0)
* 记住原假设是我们希望去推翻的

---





### 假设检验在模型比较中的应用

![image-20210804164839654](https://raw.githubusercontent.com/Rainiwalk/Rain_image/main/2021/20210804164839.png)

第一点，检验x对y是否显著，如果不显著那么β1就可以不要了，y就和x没关系。

第二点，注意因为一元线性方程它只有一个参数，所以检测方程显著性和检测回归系数显著性是一致的。但如果是多元的，就不一样了。



